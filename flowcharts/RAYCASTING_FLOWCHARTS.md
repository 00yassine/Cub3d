# ğŸ¨ Visual Raycasting Guide - Diagrams & Flowcharts

> **âœ¨ NEW: Interactive SVG Flowcharts Available!**
> Professional, scalable flowcharts now available in the `flowcharts/` directory.
> Open `flowcharts/index.html` in your browser for an interactive experience!
>
> ğŸ“‚ **SVG Files:**
>
> - `01_system_overview.svg` - Main loop visualization
> - `02_dda_algorithm.svg` - DDA ray casting algorithm
> - `03_texture_mapping.svg` - Texture rendering process
> - `04_problems_solutions.svg` - Common issues & fixes
> - `05_visualization.svg` - Complete raycasting scene
>
> ğŸŒ **View Online:** Open `flowcharts/index.html` in any browser
> ğŸ“– **Documentation:** See `flowcharts/README.md` for details

---

## ğŸ“Š Complete System Flowchart (ASCII Version)

> ğŸ’¡ **Tip:** For better visualization, check `flowcharts/01_system_overview.svg`

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                     CUB3D RAYCASTING ENGINE                          â•‘
â•‘                         Main Loop Flow                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  START  â”‚
                            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Initialize MLX       â”‚
                    â”‚   Load Textures        â”‚
                    â”‚   Setup Window         â”‚
                    â”‚   Parse Map            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Setup Hooks:         â”‚
                    â”‚   â€¢ Key Press          â”‚
                    â”‚   â€¢ Key Release        â”‚
                    â”‚   â€¢ Mouse Move         â”‚
                    â”‚   â€¢ Window Close       â”‚
                    â”‚   â€¢ Loop Hook          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
         â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
         â•‘           MLX MAIN LOOP (60 FPS)              â•‘
         â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
         â•‘   â”‚                                       â”‚   â•‘
         â•‘   â”‚  1. INPUT PROCESSING                 â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ Check Input Flags               â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  â€¢ k_up, k_down (W/S)          â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  â€¢ k_left, k_right (arrows)    â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  â€¢ k_view_left/right (A/D)     â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  â€¢ speed (Shift)               â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  2. MOVEMENT UPDATE                   â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ Calculate New Position         â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  new_x = fpx + cos(Î¸)*speed   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚  new_y = fpy + sin(Î¸)*speed   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚                                 â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚ Collision Check (X-axis) â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚ if !is_wall(new_x, fpy)  â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚    fpx = new_x âœ“         â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚                                 â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚ Collision Check (Y-axis) â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚ if !is_wall(fpx, new_y)  â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â”‚    fpy = new_y âœ“         â”‚   â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  3. ROTATION UPDATE                   â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ angle += ROT_SPEED * direction â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ Normalize to [0, 2Ï€)           â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  4. CLEAR FRAME BUFFER                â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ memset(img_buffer, 0, size)    â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚   â•‘
         â•‘   â”‚  â•‘  5. RAYCASTING (Main Part)    â•‘   â”‚   â•‘
         â•‘   â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£   â”‚   â•‘
         â•‘   â”‚  â•‘                               â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  FOR x = 0 to SCREEN_WIDTH:  â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚ A. Calculate Ray Angle â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    cur_angle = player_ â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    angle - FOV/2 +     â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    x * (FOV/WIDTH)     â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â”‚              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â–¼              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚ B. Cast Ray (DDA)      â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚                         â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ Horizontal Check â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Find Y gridlineâ”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Step by TILE_H â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Until wall hit â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Record distanceâ”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚          âˆ©             â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ Vertical Check   â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Find X gridlineâ”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Step by TILE_W â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Until wall hit â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ â€¢ Record distanceâ”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚          â”‚             â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚          â–¼             â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ Choose Closest   â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â”‚ dist = min(h,v)  â”‚  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â”‚              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â–¼              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚ C. Fix Fisheye         â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    dist *= cos(Î”Î¸)     â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â”‚              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â–¼              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚ D. Select Texture      â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    â€¢ North/South       â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚    â€¢ East/West         â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â”‚              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘              â–¼              â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚ E. Draw Column         â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚                         â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â€¢ Ceiling pixels      â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â€¢ Textured wall       â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â”‚  â€¢ Floor pixels        â”‚ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘                               â•‘   â”‚   â•‘
         â•‘   â”‚  â•‘  END FOR                      â•‘   â”‚   â•‘
         â•‘   â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  6. DRAW MINIMAP (optional)           â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ Draw 2D map overlay            â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ Show player position           â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ Show player direction          â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                 â”‚                      â”‚   â•‘
         â•‘   â”‚                 â–¼                      â”‚   â•‘
         â•‘   â”‚  7. DISPLAY FRAME                     â”‚   â•‘
         â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â•‘
         â•‘   â”‚  â”‚ mlx_put_image_to_window()      â”‚ â”‚   â•‘
         â•‘   â”‚  â”‚ Show completed frame           â”‚ â”‚   â•‘
         â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â•‘
         â•‘   â”‚                                       â”‚   â•‘
         â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
         â•‘                   â”‚                           â•‘
         â•‘                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
         â•‘                                 â”‚             â•‘
         â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                           â”‚
                                           â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  REPEAT  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ DDA Algorithm Detailed Flow

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              DDA (Digital Differential Analysis)                   â•‘
â•‘                   Ray-Wall Intersection                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Input: Player Position (px, py), Ray Angle (Î¸)
Output: Hit Point (hx, hy), Distance, Wall Type

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HORIZONTAL RAY CASTING                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: Find First Horizontal Grid Intersection
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Grid:  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â† y = tile_y * TILE_SIZE
                            â† y = (tile_y+1) * TILE_SIZE
           â”€â”€â”€â”€â”€â€¢â”€â”€â”€â”€â”€â”€â”€â”€â”€  â† First intersection
                â†‘
              Player

    Code:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ tile_y = floor(py / TILE_SIZE)        â”‚
    â”‚                                        â”‚
    â”‚ if (sin(Î¸) > 0):  // Ray going UP     â”‚
    â”‚    y = (tile_y + 1) * TILE_SIZE       â”‚
    â”‚ else:             // Ray going DOWN   â”‚
    â”‚    y = tile_y * TILE_SIZE             â”‚
    â”‚                                        â”‚
    â”‚ x = px + (y - py) / tan(Î¸)            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 2: Calculate Step Size
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ step_y = TILE_SIZE (if going UP)      â”‚
    â”‚        = -TILE_SIZE (if going DOWN)   â”‚
    â”‚                                        â”‚
    â”‚ step_x = step_y / tan(Î¸)              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 3: Step Through Grid Until Wall Hit
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ while (!is_wall(x, y Â± Îµ)):           â”‚
    â”‚     x += step_x                        â”‚
    â”‚     y += step_y                        â”‚
    â”‚ end while                              â”‚
    â”‚                                        â”‚
    â”‚ // Now (x, y) is at wall              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Visual:
    Player
      â€¢
       â•² Ray
        â•²
    â”€â”€â”€â”€â”€â€¢â”€â”€â”€â”€â”€ Grid line (check)
          â•²
    â”€â”€â”€â”€â”€â”€â”€â€¢â”€â”€â”€ Grid line (check)
            â•²
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ˆ  Wall hit! (stop)


STEP 4: Calculate Distance
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ h_dist = âˆš[(x-px)Â² + (y-py)Â²]         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     VERTICAL RAY CASTING                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 1: Find First Vertical Grid Intersection
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Grid:       â”‚           â”‚
                â”‚     â€¢     â”‚  â† First intersection
                â”‚    â•±      â”‚
                â”‚   â•±       â”‚
                â”‚ Player    â”‚
                â”‚           â”‚

    Code:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ tile_x = floor(px / TILE_SIZE)        â”‚
    â”‚                                        â”‚
    â”‚ if (cos(Î¸) > 0):  // Ray going RIGHT â”‚
    â”‚    x = (tile_x + 1) * TILE_SIZE       â”‚
    â”‚ else:             // Ray going LEFT  â”‚
    â”‚    x = tile_x * TILE_SIZE             â”‚
    â”‚                                        â”‚
    â”‚ y = py + (x - px) * tan(Î¸)            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 2-4: Similar to Horizontal (but with vertical steps)


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CHOOSE CLOSEST HIT                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ if (h_dist < v_dist):                 â”‚
    â”‚     hit = horizontal_hit              â”‚
    â”‚     is_vertical = 0                   â”‚
    â”‚ else:                                  â”‚
    â”‚     hit = vertical_hit                â”‚
    â”‚     is_vertical = 1                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Result: Closest wall intersection found!
```

---

## ğŸ¨ Texture Mapping Process

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      TEXTURE MAPPING                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Calculate Texture X Coordinate
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Where on the wall did we hit?

    Wall Tile (64x64):
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  0
    â”‚                â”‚
    â”‚     Hit at     â”‚
    â”‚     x=45       â”‚  â† We hit here
    â”‚        â†“       â”‚
    â”‚        â€¢       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  64

    Code:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ if (vertical wall):                         â”‚
    â”‚     offset = hit_y % TILE_SIZE              â”‚
    â”‚ else:                                        â”‚
    â”‚     offset = hit_x % TILE_SIZE              â”‚
    â”‚                                              â”‚
    â”‚ tex_x = (offset * texture_width) / TILE_SIZEâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STEP 2: Calculate Wall Height on Screen
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Formula: wall_height = (TILE_SIZE Ã— SCREEN_HEIGHT) / distance

    Example:

    Close Wall (dist=100):       Far Wall (dist=400):
    wall_h = 64Ã—800/100         wall_h = 64Ã—800/400
           = 512 pixels                = 128 pixels

    Screen:                     Screen:
    â”Œâ”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”
    â”‚     â”‚                     â”‚     â”‚
    â”‚     â”‚                     â”œâ”€â”€â”€â”€â”€â”¤  â† Wall
    â”‚     â”‚                     â”‚     â”‚
    â”‚     â”‚                     â”‚     â”‚
    â”‚     â”‚                     â”‚     â”‚
    â”œâ”€â”€â”€â”€â”€â”¤  â† Wall             â”‚     â”‚
    â”‚     â”‚                     â”‚     â”‚
    â”‚     â”‚                     â”‚     â”‚
    â”‚     â”‚                     â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”˜
     Tall                        Short


STEP 3: Calculate Draw Start/End
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ center = SCREEN_HEIGHT / 2           â”‚
    â”‚ draw_start = center - wall_height/2  â”‚
    â”‚ draw_end = center + wall_height/2    â”‚
    â”‚                                       â”‚
    â”‚ // Clamp to screen bounds            â”‚
    â”‚ if (draw_start < 0):                 â”‚
    â”‚     draw_start = 0                   â”‚
    â”‚ if (draw_end >= SCREEN_HEIGHT):      â”‚
    â”‚     draw_end = SCREEN_HEIGHT - 1     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Screen (800px):
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  0
    â”‚ Ceiling â”‚  â† draw_start = 300
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  300
    â”‚         â”‚
    â”‚  WALL   â”‚  â† Wall pixels
    â”‚         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  500  â† draw_end
    â”‚  Floor  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  800


STEP 4: Map Texture Y to Screen Y
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Problem: Map 64-pixel texture to variable wall height

    Solution: Calculate step size

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ step = texture_height / wall_height      â”‚
    â”‚                                           â”‚
    â”‚ tex_pos = (draw_start - center +         â”‚
    â”‚            wall_height/2) Ã— step         â”‚
    â”‚                                           â”‚
    â”‚ for each screen_y from draw_start to     â”‚
    â”‚                          draw_end:       â”‚
    â”‚     tex_y = (int)tex_pos % tex_height   â”‚
    â”‚     color = texture[tex_y][tex_x]        â”‚
    â”‚     put_pixel(screen_x, screen_y, color) â”‚
    â”‚     tex_pos += step                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Mapping:

    Texture (64px)      Screen (200px)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  0       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  300
    â”‚  AAAA  â”‚          â”‚  AAAA  â”‚
    â”‚  BBBB  â”‚  20      â”‚  BBBB  â”‚  360
    â”‚  CCCC  â”‚  40  â†’   â”‚  CCCC  â”‚  420
    â”‚  DDDD  â”‚          â”‚  DDDD  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  64      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  500

    Each texture line maps to multiple screen lines


STEP 5: Handle Texture Flipping
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    Without flip:               With flip:

    Looking RIGHT â†’            Looking LEFT â†
    â”Œâ”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚ ABC  â”‚                   â”‚ ABC  â”‚
    â”‚ ABC  â”‚                   â”‚ ABC  â”‚
    â””â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”˜
    Correct!                   Correct!

    â”Œâ”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚ CBA  â”‚  âœ— Wrong!         â”‚ ABC  â”‚  âœ“ Fixed!
    â””â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”˜

    Code:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ if ((vertical && cos(angle) < 0) ||     â”‚
    â”‚     (!vertical && sin(angle) > 0)):     â”‚
    â”‚     tex_x = tex_width - tex_x - 1       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Problem-Solution Flowcharts

### Problem 1: Fisheye Effect

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEM: Fisheye Distortion       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Symptom:           â”‚
    â”‚  â€¢ Curved walls     â”‚
    â”‚  â€¢ Bulging center   â”‚
    â”‚  â€¢ Wrong distances  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Cause:             â”‚
    â”‚  Using raw ray      â”‚
    â”‚  distances instead  â”‚
    â”‚  of perpendicular   â”‚
    â”‚  distances          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Visual:                        â”‚
    â”‚       Player                    â”‚
    â”‚          â”‚â•²                      â”‚
    â”‚          â”‚ â•² ray_dist (WRONG)   â”‚
    â”‚          â”‚  â•²                    â”‚
    â”‚   perp_  â”‚   â•²                   â”‚
    â”‚   dist   â”‚    Wall               â”‚
    â”‚ (CORRECT)â”‚                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SOLUTION:                      â”‚
    â”‚                                 â”‚
    â”‚  corrected_dist =               â”‚
    â”‚     ray_dist Ã—                  â”‚
    â”‚     cos(ray_angle - player_angle)â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Result:            â”‚
    â”‚  âœ“ Flat walls       â”‚
    â”‚  âœ“ Correct depth    â”‚
    â”‚  âœ“ No distortion    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 2: Wall Gaps

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEM: Gaps Between Walls       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Symptom:           â”‚
    â”‚  â€¢ Thin black lines â”‚
    â”‚  â€¢ Seeing through   â”‚
    â”‚  â€¢ Flickering       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Cause:                 â”‚
    â”‚  Floating point         â”‚
    â”‚  precision at grid      â”‚
    â”‚  boundaries             â”‚
    â”‚                         â”‚
    â”‚  Example:               â”‚
    â”‚  63.99999 vs 64.00001   â”‚
    â”‚  Different tiles!       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Visual:                        â”‚
    â”‚                                 â”‚
    â”‚  Grid boundary:                 â”‚
    â”‚      â”‚                          â”‚
    â”‚      â”‚ â† Might check wrong side â”‚
    â”‚  â”€â”€â”€â”€â”¼â”€â”€â”€â”€                      â”‚
    â”‚      â”‚                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SOLUTION:                      â”‚
    â”‚                                 â”‚
    â”‚  Add small epsilon (1e-6):      â”‚
    â”‚                                 â”‚
    â”‚  if (going_up):                 â”‚
    â”‚      check(x, y + epsilon)      â”‚
    â”‚  else:                          â”‚
    â”‚      check(x, y - epsilon)      â”‚
    â”‚                                 â”‚
    â”‚  This ensures checking correct  â”‚
    â”‚  side of boundary               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Result:            â”‚
    â”‚  âœ“ No gaps          â”‚
    â”‚  âœ“ Solid walls      â”‚
    â”‚  âœ“ No flickering    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 3: Division by Zero

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROBLEM: Division by Zero         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Symptom:           â”‚
    â”‚  â€¢ Crash            â”‚
    â”‚  â€¢ Infinite loop    â”‚
    â”‚  â€¢ NaN values       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Cause:                 â”‚
    â”‚  tan(Ï€/2) = âˆ          â”‚
    â”‚  cos(Ï€/2) = 0          â”‚
    â”‚                         â”‚
    â”‚  Dividing by these      â”‚
    â”‚  causes problems        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Critical Angles:               â”‚
    â”‚                                 â”‚
    â”‚  Ï€/2 (90Â°)  â†’ Pointing UP       â”‚
    â”‚  3Ï€/2 (270Â°)â†’ Pointing DOWN     â”‚
    â”‚  0 (0Â°)     â†’ Pointing RIGHT    â”‚
    â”‚  Ï€ (180Â°)   â†’ Pointing LEFT     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SOLUTION:                      â”‚
    â”‚                                 â”‚
    â”‚  Check before dividing:         â”‚
    â”‚                                 â”‚
    â”‚  if (fabs(tan(angle)) < 1e-9):  â”‚
    â”‚      step_x = 0  // Pure horiz  â”‚
    â”‚  else:                          â”‚
    â”‚      step_x = step_y/tan(angle) â”‚
    â”‚                                 â”‚
    â”‚  if (dist < epsilon):           â”‚
    â”‚      dist = epsilon             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Result:            â”‚
    â”‚  âœ“ No crashes       â”‚
    â”‚  âœ“ Smooth rotation  â”‚
    â”‚  âœ“ All angles work  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Quick Reference Diagrams

### Angle Reference

```
              90Â° (Ï€/2)
              North â†‘
                 0,1
                  â”‚
                  â”‚
180Â° (Ï€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€ 0Â°/360Â° (0/2Ï€)
West              â”‚            East
 -1,0             â”‚            1,0
                  â”‚
                  â”‚
              0,-1
              South â†“
             270Â° (3Ï€/2)
```

### Ray Angles for Screen

```
Screen Position:  LEFT    CENTER    RIGHT
                   â”‚        â”‚        â”‚
Ray Angle:     Î¸-FOV/2     Î¸      Î¸+FOV/2

Example (FOV=60Â°, Player facing 90Â°):
                  60Â°      90Â°      120Â°
```

### Collision Detection

```
New Position Check:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Try move to (new_x, y)  â”‚  â† Check X first
â”‚  if safe:                â”‚
â”‚      x = new_x           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Try move to (x, new_y)  â”‚  â† Then check Y
â”‚  if safe:                â”‚
â”‚      y = new_y           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Why separate?
  â†’ Allows sliding along walls
  â†’ Smoother movement
  â†’ Better game feel
```

### Texture Selection

```
Hit Type:       Direction:       Texture:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Vertical        cos(Î¸) > 0       EAST
Vertical        cos(Î¸) < 0       WEST
Horizontal      sin(Î¸) > 0       NORTH
Horizontal      sin(Î¸) < 0       SOUTH
```

---

## ğŸ“ Mathematical Formulas

### Distance Calculation

```
Distance = âˆš[(xâ‚‚-xâ‚)Â² + (yâ‚‚-yâ‚)Â²]

In code:
distance = hypot(hit_x - player_x, hit_y - player_y);
```

### Wall Height

```
wall_height = (TILE_SIZE Ã— SCREEN_HEIGHT) / distance

Relationship:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ distance â†‘  â†’ height â†“   â”‚  (Far = Small)
â”‚ distance â†“  â†’ height â†‘   â”‚  (Close = Big)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Fisheye Correction

```
corrected_distance = raw_distance Ã— cos(Î”Î¸)

where: Î”Î¸ = ray_angle - player_angle
```

### Texture Mapping

```
tex_x = (hit_position % TILE_SIZE) Ã— tex_width / TILE_SIZE
tex_y = screen_y Ã— tex_height / wall_height

step = tex_height / wall_height
```

---

## ğŸ® Input to Output Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Key: 'W' â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ k_up = 1      â”‚  (Flag set)
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ new_x = x + cos(Î¸)Ã—speed   â”‚  (Calculate)
â”‚ new_y = y + sin(Î¸)Ã—speed   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Collision check    â”‚  (Validate)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update position    â”‚  (Apply)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Raycast new view   â”‚  (Render)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display on screen  â”‚  (Output)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ† Complete Example: Single Ray

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    EXAMPLE: Casting One Ray
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INPUT:
  Player position: (200, 200)
  Player angle: 45Â° (Ï€/4 radians)
  Screen column: x = 400 (middle of 800px screen)

STEP 1: Calculate Ray Angle
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  FOV = 60Â° = Ï€/3
  step = Ï€/3 / 800 = 0.00131
  ray_angle = Ï€/4 - Ï€/6 + 400Ã—0.00131
            = 45Â° - 30Â° + 30Â°
            = 45Â°

STEP 2: Cast Ray (DDA)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Horizontal check:
    â€¢ First intersection: y=256, x=256
    â€¢ Step: y+=64, x+=64
    â€¢ Hit wall at: (384, 384)
    â€¢ Distance: âˆš[(384-200)Â² + (384-200)Â²] = 260.2

  Vertical check:
    â€¢ First intersection: x=256, y=256
    â€¢ Step: x+=64, y+=64
    â€¢ Hit wall at: (320, 320)
    â€¢ Distance: âˆš[(320-200)Â² + (320-200)Â²] = 169.7

  Closest: Vertical hit at (320, 320), dist=169.7

STEP 3: Fix Fisheye
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  corrected_dist = 169.7 Ã— cos(45Â° - 45Â°)
                 = 169.7 Ã— cos(0Â°)
                 = 169.7 Ã— 1
                 = 169.7

STEP 4: Select Texture
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Vertical hit, cos(45Â°) > 0
  â†’ Texture = EAST

STEP 5: Calculate Wall Height
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  wall_height = (64 Ã— 800) / 169.7
              = 301 pixels

STEP 6: Draw Column
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  draw_start = 400 - 301/2 = 249
  draw_end = 400 + 301/2 = 551

  Pixels 0-249:   Ceiling (blue)
  Pixels 249-551: Textured wall
  Pixels 551-800: Floor (gray)

OUTPUT:
  Column 400 drawn with 301-pixel tall wall!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

**END OF VISUAL DOCUMENTATION**

_For detailed code explanations, see RAYCASTING_DOCUMENTATION.md_
